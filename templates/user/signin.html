{% extends 'base.html' %}

{% block title %}
    ë¡œê·¸ì¸
{% endblock %}
{% block content %}
    <div class="container">
            <h1> ë¡œê·¸ì¸</h1>
            <form method="post" action="/sign-in/">
                {% csrf_token %}
                <div>
                    <label for="username">ì´ë¦„</label>
                    <input type="text" id="username" name="username">
                </div>
                <div>
                    <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="password" name="password">
                   
                </div>
                <hr>
                {% if error %}
                    <div class="alert alert-danger" role="alert">
                        {{ error }}
                    </div>
                {% endif %}

                
                <button type="submit">ë¡œê·¸ì¸</button>
                <a href="{% url 'user:github' %}">ğŸ˜¼ê¹ƒí—ˆë¸Œë¡œ ë¡œê·¸ì¸ğŸ˜½</a>
                <a href="{% url 'user:kakao' %}">ğŸ¯ì¹´ì¹´ì˜¤ë¡œ ë¡œê·¸ì¸ğŸ¶</a>
              
            </form>
            <div >
                <button id="find_pw">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</button> 
            </div>
            <div hidden id="hidden_box">
                <input type="text" id='find_id' placeholder="usernameì„ ì ì–´ì£¼ì„¸ìš”.">
                <button id="find">ë‹¤ìŒ</button>
            </div>
            

   
        <a href="{% url 'user:sign-up' %}" >íšŒì›ê°€ì… í˜ì´ì§€ë¡œ</a>
    </div>
{% endblock %}
{% block script%}
<script>
    const findBtn = document.getElementById('find')
    const hiddenBox = document.getElementById('hidden_box')
    const findPw = document.getElementById('find_pw')
    findPw.addEventListener('click',()=>{
        hiddenBox.hidden = false
    })
    const next1 = () => {
        
        data = document.getElementById('find_id').value
        $.ajax({
            type:'POST',
            url:'/isid/',
            data:JSON.stringify(data),
            success:function(data){
                if (data.result){
                    alert(data.result);
                }
                if ('ok' in data){
                    window.location.reload()
                }
                else if ('sns' in data){
                    window.location.reload()
                }
                
            }

       });
    
    }
    findBtn.addEventListener('click',next1)
    $.ajaxSetup({
        headers: { "X-CSRFToken": '{{csrf_token}}' }
      });
</script>
{% endblock %}